/* To prevent any potential data loss issues, you should review this script in detail before running it outside the context of the database designer.*/
BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT
BEGIN TRANSACTION
GO
CREATE TABLE dbo.Tmp_LITERALS
	(
	LIT_ID numeric(18, 0) NOT NULL,
	LIT_DESCRIPTION varchar(500) NULL,
	LIT_KEY varchar(500) NULL
	)  ON [PRIMARY]
GO
ALTER TABLE dbo.Tmp_LITERALS SET (LOCK_ESCALATION = TABLE)
GO
DECLARE @v sql_variant 
SET @v = N'Table to store literals'
EXECUTE sp_addextendedproperty N'MS_Description', @v, N'SCHEMA', N'dbo', N'TABLE', N'Tmp_LITERALS', NULL, NULL
GO
DECLARE @v sql_variant 
SET @v = N'Identificator'
EXECUTE sp_addextendedproperty N'MS_Description', @v, N'SCHEMA', N'dbo', N'TABLE', N'Tmp_LITERALS', N'COLUMN', N'LIT_ID'
GO
DECLARE @v sql_variant 
SET @v = N'Literal Description'
EXECUTE sp_addextendedproperty N'MS_Description', @v, N'SCHEMA', N'dbo', N'TABLE', N'Tmp_LITERALS', N'COLUMN', N'LIT_DESCRIPTION'
GO
IF EXISTS(SELECT * FROM dbo.LITERALS)
	 EXEC('INSERT INTO dbo.Tmp_LITERALS (LIT_ID, LIT_DESCRIPTION, LIT_KEY)
		SELECT LIT_ID, LIT_DESCRIPTION, LIT_KEY FROM dbo.LITERALS WITH (HOLDLOCK TABLOCKX)')
GO
ALTER TABLE dbo.TARIFFS_IN_GROUPS
	DROP CONSTRAINT FK_TARIFFS_IN_GROUPS_LITERALS
GO
ALTER TABLE dbo.TARIFFS_IN_GROUPS
	DROP CONSTRAINT FK_TARIFFS_IN_GROUPS_LITERALS1
GO
ALTER TABLE dbo.TARIFFS_IN_GROUPS
	DROP CONSTRAINT FK_TARIFFS_IN_GROUPS_LITERALS2
GO
ALTER TABLE dbo.TARIFFS_IN_GROUPS
	DROP CONSTRAINT FK_TARIFFS_IN_GROUPS_LITERALS3
GO
ALTER TABLE dbo.GROUPS
	DROP CONSTRAINT FK_GROUPS_LITERALS
GO
ALTER TABLE dbo.INSTALLATIONS
	DROP CONSTRAINT FK_INSTALLATIONS_LITERALS
GO
ALTER TABLE dbo.INSTALLATIONS
	DROP CONSTRAINT FK_INSTALLATIONS_LITERALS1
GO
ALTER TABLE dbo.INSTALLATIONS
	DROP CONSTRAINT FK_INSTALLATIONS_LITERALS_SERVICE_FEE
GO
ALTER TABLE dbo.INSTALLATIONS
	DROP CONSTRAINT FK_INSTALLATIONS_LITERALS_SERVICE_PARK
GO
ALTER TABLE dbo.INSTALLATIONS
	DROP CONSTRAINT FK_INSTALLATIONS_LITERALS_SERVICE_SUBTOTAL
GO
ALTER TABLE dbo.INSTALLATIONS
	DROP CONSTRAINT FK_INSTALLATIONS_LITERALS_SERVICE_TOTAL
GO
ALTER TABLE dbo.INSTALLATIONS
	DROP CONSTRAINT FK_INSTALLATIONS_LITERALS_SERVICE_VAT
GO
ALTER TABLE dbo.USER_APPROVAL_QUESTION_VERSIONS
	DROP CONSTRAINT FK_USER_APPROVAL_QUESTION_VERSION_LITERALS
GO
ALTER TABLE dbo.SERVICE_CHARGE_TYPES
	DROP CONSTRAINT FK_SERVICE_CHARGE_TYPES_LITERALS
GO
ALTER TABLE dbo.LITERAL_LANGUAGES
	DROP CONSTRAINT FK_LITERAL_LANGUAGES_LITERALS
GO
ALTER TABLE dbo.PAYMENT_SUBTYPES
	DROP CONSTRAINT FK_PAYMENT_SUBTYPES_LITERALS
GO
ALTER TABLE dbo.PAYMENT_TYPES
	DROP CONSTRAINT FK_PAYMENT_TYPES_LITERALS
GO
ALTER TABLE dbo.RECHARGE_COUPONS_STATUS
	DROP CONSTRAINT FK_RECHARGE_COUPONS_STATUS_LITERALS
GO
ALTER TABLE dbo.TARIFFS
	DROP CONSTRAINT FK_TARIFFS_LITERALS
GO
DROP TABLE dbo.LITERALS
GO
EXECUTE sp_rename N'dbo.Tmp_LITERALS', N'LITERALS', 'OBJECT' 
GO
ALTER TABLE dbo.LITERALS ADD CONSTRAINT
	PK_LITERALS_1 PRIMARY KEY CLUSTERED 
	(
	LIT_ID
	) WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]

GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.TARIFFS ADD CONSTRAINT
	FK_TARIFFS_LITERALS FOREIGN KEY
	(
	TAR_LIT_ID
	) REFERENCES dbo.LITERALS
	(
	LIT_ID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.TARIFFS SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.RECHARGE_COUPONS_STATUS ADD CONSTRAINT
	FK_RECHARGE_COUPONS_STATUS_LITERALS FOREIGN KEY
	(
	RCOUPS_LIT_ID
	) REFERENCES dbo.LITERALS
	(
	LIT_ID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.RECHARGE_COUPONS_STATUS SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.PAYMENT_TYPES ADD CONSTRAINT
	FK_PAYMENT_TYPES_LITERALS FOREIGN KEY
	(
	PAT_LIT_ID
	) REFERENCES dbo.LITERALS
	(
	LIT_ID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.PAYMENT_TYPES SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.PAYMENT_SUBTYPES ADD CONSTRAINT
	FK_PAYMENT_SUBTYPES_LITERALS FOREIGN KEY
	(
	PAST_LIT_ID
	) REFERENCES dbo.LITERALS
	(
	LIT_ID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.PAYMENT_SUBTYPES SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.LITERAL_LANGUAGES ADD CONSTRAINT
	FK_LITERAL_LANGUAGES_LITERALS FOREIGN KEY
	(
	LITL_LIT_ID
	) REFERENCES dbo.LITERALS
	(
	LIT_ID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.LITERAL_LANGUAGES SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.SERVICE_CHARGE_TYPES ADD CONSTRAINT
	FK_SERVICE_CHARGE_TYPES_LITERALS FOREIGN KEY
	(
	SECHT_LIT_ID
	) REFERENCES dbo.LITERALS
	(
	LIT_ID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.SERVICE_CHARGE_TYPES SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.USER_APPROVAL_QUESTION_VERSIONS ADD CONSTRAINT
	FK_USER_APPROVAL_QUESTION_VERSION_LITERALS FOREIGN KEY
	(
	UAQV_LIT_ID
	) REFERENCES dbo.LITERALS
	(
	LIT_ID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.USER_APPROVAL_QUESTION_VERSIONS SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.INSTALLATIONS ADD CONSTRAINT
	FK_INSTALLATIONS_LITERALS FOREIGN KEY
	(
	INS_LIT_ID
	) REFERENCES dbo.LITERALS
	(
	LIT_ID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.INSTALLATIONS ADD CONSTRAINT
	FK_INSTALLATIONS_LITERALS1 FOREIGN KEY
	(
	INS_TOLL_PENDING_MSG_LIT_ID
	) REFERENCES dbo.LITERALS
	(
	LIT_ID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.INSTALLATIONS ADD CONSTRAINT
	FK_INSTALLATIONS_LITERALS_SERVICE_FEE FOREIGN KEY
	(
	INS_SERVICE_FEE_LIT_ID
	) REFERENCES dbo.LITERALS
	(
	LIT_ID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.INSTALLATIONS ADD CONSTRAINT
	FK_INSTALLATIONS_LITERALS_SERVICE_PARK FOREIGN KEY
	(
	INS_SERVICE_PARK_LIT_ID
	) REFERENCES dbo.LITERALS
	(
	LIT_ID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.INSTALLATIONS ADD CONSTRAINT
	FK_INSTALLATIONS_LITERALS_SERVICE_SUBTOTAL FOREIGN KEY
	(
	INS_SERVICE_SUBTOTAL_LIT_ID
	) REFERENCES dbo.LITERALS
	(
	LIT_ID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.INSTALLATIONS ADD CONSTRAINT
	FK_INSTALLATIONS_LITERALS_SERVICE_TOTAL FOREIGN KEY
	(
	INS_SERVICE_TOTAL_LIT_ID
	) REFERENCES dbo.LITERALS
	(
	LIT_ID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.INSTALLATIONS ADD CONSTRAINT
	FK_INSTALLATIONS_LITERALS_SERVICE_VAT FOREIGN KEY
	(
	INS_SERVICE_VAT_LIT_ID
	) REFERENCES dbo.LITERALS
	(
	LIT_ID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.INSTALLATIONS SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.GROUPS ADD CONSTRAINT
	FK_GROUPS_LITERALS FOREIGN KEY
	(
	GRP_LIT_ID
	) REFERENCES dbo.LITERALS
	(
	LIT_ID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.GROUPS SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.TARIFFS_IN_GROUPS ADD CONSTRAINT
	FK_TARIFFS_IN_GROUPS_LITERALS FOREIGN KEY
	(
	TARGR_LIT_ID
	) REFERENCES dbo.LITERALS
	(
	LIT_ID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.TARIFFS_IN_GROUPS ADD CONSTRAINT
	FK_TARIFFS_IN_GROUPS_LITERALS1 FOREIGN KEY
	(
	TARGR_STEP1_LIT_ID
	) REFERENCES dbo.LITERALS
	(
	LIT_ID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.TARIFFS_IN_GROUPS ADD CONSTRAINT
	FK_TARIFFS_IN_GROUPS_LITERALS2 FOREIGN KEY
	(
	TARGR_STEP2_LIT_ID
	) REFERENCES dbo.LITERALS
	(
	LIT_ID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.TARIFFS_IN_GROUPS ADD CONSTRAINT
	FK_TARIFFS_IN_GROUPS_LITERALS3 FOREIGN KEY
	(
	TARGR_STEP3_LIT_ID
	) REFERENCES dbo.LITERALS
	(
	LIT_ID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.TARIFFS_IN_GROUPS SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
